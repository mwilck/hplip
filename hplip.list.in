# @configure_input@
#
#  ESP Package Manager (EPM) "list" file.
#
#  (c) 2008-2009 Copyright Hewlett-Packard Development Company, LP
#
#  Use this configuration for new distributions that support CUPSDDK drv files.
#    ./configure --prefix=/usr
#
#  Use this configuration for old distributions that do *not* support CUPSDDK drv files.
#    ./configure --prefix=/usr --disable-foomatic-drv-install --enable-foomatic-ppd-install --enable-foomatic-rip-hplip-install
#
#  Use this command to build the hplipfull package (print, scan, fax, hp-toolbox, hp-setup).
#    make rpm_regular | deb_regular
#
#  Use this command to build the hpliplight package (print, scan).
#    make rpm_unleaded | deb_unleaded
#
#

%product HPLIP
%copyright (c) 2004-2009 Copyright Hewlett-Packard Development Company, LP
%vendor Hewlett-Packard
%if PLUGIN
%license prnt/plugins/license.txt
%else
%license COPYING
%endif
%readme doc/index.html
%version @VERSION@
%description The Hewlett-Packard Linux Imaging and Printing (HPLIP) system
%description provides a unified single and multi-function connectivity
%description driver solution. HPLIPLITE provides support for print and scan only.
%description HPLIPFULL provides support for print, scan, fax and toolbox.

%format rpm deb portable

$prefix=@prefix@
$exec_prefix=@exec_prefix@
$bindir=@bindir@
$datarootdir=@datarootdir@
$datadir=@datadir@
$libdir=@libdir@
$srcdir=@srcdir@
$pyexecdir=@pyexecdir@
$icondir=@icondir@
$systraydir=@systraydir@
$docdir=@hpdocdir@
$version=@VERSION@
$internal_tag=@PACKAGE_BUGREPORT@

$home=@abs_datadir@/hplip
$ppd=@abs_ppddir@
$cupsbackend=@cupsbackenddir@
$cupsfilter=@cupsfilterdir@
$drv=@abs_drvdir@
$scan-build=@scan_build@
$hpaio-version=libsane-hpaio.so.1.0.0
$foomatic-rip-install=@epm_foomatic_rip_hplip_install@
$foomatic-ppd-install=@epm_foomatic_ppd_install@
$qt4-install=@epm_qt4_install@
$machine=@platform@

%system linux
%postinstall ldconfig
%system all

f 0755 root root $bindir/hpijs .libs/hpijs
f 0644 root root /etc/hp/hplip.conf hplip.conf
f 0644 root root $home/data/models/models.dat data/models/models.dat
f 0700 root root $cupsbackend/hp .libs/hp
f 0755 root root $bindir/hp-mkuri .libs/hp-mkuri
f 0644 root root $drv/hpijs.drv prnt/drv/hpijs.drv
%if foomatic-rip-install
f 0755 root root $cupsfilter/foomatic-rip-hplip prnt/hpijs/foomatic-rip-hplip
%endif
%if foomatic-ppd-install
f 0644 root root $ppd/HP ppd/*.ppd.gz
%endif
f 0644 root root $ppd/HP prnt/ps/*.ppd.gz

%system darwin
f 0755 root root $libdir/libhpmud.0.0.4.dylib .libs/libhpmud.0.0.4.dylib
l 0755 root root $libdir/libhpmud.dylib libhpmud.0.0.4.dylib
f 0755 root root $libdir/libhpip.0.0.1.dylib .libs/libhpip.0.0.1.dylib
l 0755 root root $libdir/libhpip.dylib libhpip.0.0.1.dylib
%system !darwin
f 0755 root root $libdir/libhpmud.so.0.0.4 .libs/libhpmud.so.0.0.4
l 0755 root root $libdir/libhpmud.so libhpmud.so.0.0.4
f 0755 root root $libdir/libhpip.so.0.0.1 .libs/libhpip.so.0.0.1
l 0755 root root $libdir/libhpip.so libhpip.so.0.0.1
# Ugly fix for inconsistent libcrypto soname
#l 0755 root root $libdir/libcrypto.so.6 libcrypto.so.0.9.8
%system all

%if scan-build
%system darwin
f 0755 root root $libdir/sane/${hpaio-version}.dylib .libs/${hpaio-version}.dylib
l 0755 root root $libdir/sane/libsane-hpaio.dylib ${hpaio-version}.dylib
%system !darwin
f 0755 root root $libdir/sane/${hpaio-version} .libs/${hpaio-version}
l 0755 root root $libdir/sane/libsane-hpaio.so ${hpaio-version}
l 0755 root root $libdir/sane/libsane-hpaio.so.1 ${hpaio-version}
%system all
%postinstall <<EOF
if [ -f /etc/sane.d/dll.conf ]; then
   grep -q ^#hpaio /etc/sane.d/dll.conf
   if [ $$? -eq 0 ]; then
      sed -i -e s/^#hpaio/hpaio/ /etc/sane.d/dll.conf
   else
      grep -q ^hpaio /etc/sane.d/dll.conf
      if [ $$? -ne 0 ]; then 
	 echo hpaio >>/etc/sane.d/dll.conf
      fi
   fi
fi
EOF
%endif
# end scan_build

%if !UNLEADED
%system darwin
f 0755 root root $pyexecdir/cupsext.dylib .libs/cupsext.dylib
f 0755 root root $pyexecdir/hpmudext.dylib .libs/hpmudext.dylib
f 0755 root root $pyexecdir/pcardext.dylib .libs/pcardext.dylib
f 0755 root root $pyexecdir/scanext.dylib .libs/scanext.dylib
%system !darwin
f 0755 root root $pyexecdir/cupsext.so .libs/cupsext.so
f 0755 root root $pyexecdir/hpmudext.so .libs/hpmudext.so
f 0755 root root $pyexecdir/pcardext.so .libs/pcardext.so
f 0755 root root $pyexecdir/scanext.so .libs/scanext.so
%system all
f 644 root root $icondir/hplip.desktop hplip.desktop
f 644 root root $systraydir/hplip-systray.desktop hplip-systray.desktop
f 0700 root root $cupsbackend/hpfax fax/backend/hpfax.py
f 644 root root $ppd/HP fax/ppd/*.ppd.gz
# /usr/share/hplip files
f 755 root root $home/levels.py levels.py
f 755 root root $home/toolbox.py toolbox.py
f 755 root root $home/probe.py probe.py
f 755 root root $home/__init__.py __init__.py
f 755 root root $home/hplip-install hplip-install
d 775 root root $home/fax -
f 755 root root $home/fax/__init__.py fax/__init__.py
f 755 root root $home/fax/pmlfax.py fax/pmlfax.py
f 755 root root $home/fax/soapfax.py fax/soapfax.py
f 755 root root $home/fax/coverpages.py fax/coverpages.py
f 755 root root $home/fax/fax.py fax/fax.py
f 755 root root $home/fax/faxdevice.py fax/faxdevice.py
f 755 root root $home/install.py install.py
f 755 root root $home/fab.py fab.py
f 755 root root $home/hpssd.py hpssd.py
d 775 root root $home/base -
f 755 root root $home/base base/*.py
f 644 root root $home/hpaio.desc scan/sane/hpaio.desc
f 755 root root $home/align.py align.py
f 755 root root $home/timedate.py timedate.py
d 775 root root $home/copier -
f 755 root root $home/copier/__init__.py copier/__init__.py
f 755 root root $home/copier/copier.py copier/copier.py
f 755 root root $home/makecopies.py makecopies.py
f 755 root root $home/unload.py unload.py
f 755 root root $home/scan.py scan.py
f 755 root root $home/sendfax.py sendfax.py
d 775 root root $home/data -
d 775 root root $home/data/pcl -
f 644 root root $home/data/pcl/align3_9xx.pcl.gz data/pcl/align3_9xx.pcl.gz
f 644 root root $home/data/pcl/align2_8xx.pcl.gz data/pcl/align2_8xx.pcl.gz
f 644 root root $home/data/pcl/align2_9xx.pcl.gz data/pcl/align2_9xx.pcl.gz
f 644 root root $home/data/pcl/align1_8xx.pcl.gz data/pcl/align1_8xx.pcl.gz
f 644 root root $home/data/pcl/align6_450.pcl.gz data/pcl/align6_450.pcl.gz
f 644 root root $home/data/pcl/align3_8xx.pcl.gz data/pcl/align3_8xx.pcl.gz
f 644 root root $home/data/pcl/crccal.pcl.gz data/pcl/crccal.pcl.gz
f 644 root root $home/data/pcl/crpcal.pcl.gz data/pcl/crpcal.pcl.gz
f 644 root root $home/data/pcl/align4_450.pcl.gz data/pcl/align4_450.pcl.gz
f 644 root root $home/data/pcl/colorcal1_450.pcl.gz data/pcl/colorcal1_450.pcl.gz
f 644 root root $home/data/pcl/align4_8xx.pcl.gz data/pcl/align4_8xx.pcl.gz
f 644 root root $home/data/pcl/crcaldone.pcl.gz data/pcl/crcaldone.pcl.gz
f 644 root root $home/data/pcl/align5_8xx.pcl.gz data/pcl/align5_8xx.pcl.gz
f 644 root root $home/data/pcl/align1_9xx.pcl.gz data/pcl/align1_9xx.pcl.gz
f 644 root root $home/data/pcl/crbcal.pcl.gz data/pcl/crbcal.pcl.gz
f 644 root root $home/data/pcl/crcbcal.pcl.gz data/pcl/crcbcal.pcl.gz
f 644 root root $home/data/pcl/crcpcal.pcl.gz data/pcl/crcpcal.pcl.gz
f 644 root root $home/data/pcl/colorcal2_450.pcl.gz data/pcl/colorcal2_450.pcl.gz
d 775 root root $home/data/ldl -
f 644 root root $home/data/ldl/cb2pcal.ldl.gz data/ldl/cb2pcal.ldl.gz
f 644 root root $home/data/ldl/cbcpcal.ldl.gz data/ldl/cbcpcal.ldl.gz
f 644 root root $home/data/ldl/cbccal.ldl.gz data/ldl/cbccal.ldl.gz
f 644 root root $home/data/ldl/cbccal_done.ldl.gz data/ldl/cbccal_done.ldl.gz
f 644 root root $home/data/ldl/cbbcal.ldl.gz data/ldl/cbbcal.ldl.gz
f 644 root root $home/data/ldl/cb2pcal_done.ldl.gz data/ldl/cb2pcal_done.ldl.gz
f 644 root root $home/data/ldl/cbpcal.ldl.gz data/ldl/cbpcal.ldl.gz
d 775 root root $home/data/models -
f 644 root root $home/data/models/models.dat data/models/models.dat
d 775 root root $home/data/localization -
f 644 root root $home/data/localization/hplip_de.qm data/localization/hplip_de.qm
f 644 root root $home/data/localization/hplip_es.qm data/localization/hplip_es.qm
f 644 root root $home/data/localization/hplip_zh.qm data/localization/hplip_zh.qm
f 644 root root $home/data/localization/hplip_it.qm data/localization/hplip_it.qm
f 644 root root $home/data/localization/hplip_fr.qm data/localization/hplip_fr.qm
f 644 root root $home/data/localization/hplip_ru.qm data/localization/hplip_ru.qm
f 644 root root $home/data/localization/hplip_pt.qm data/localization/hplip_pt.qm
d 775 root root $home/data/images -
d 775 root root $home/data/images/other -
f 644 root root $home/data/images/other data/images/other/*
d 775 root root $home/data/images/16x16 -
f 644 root root $home/data/images/16x16 data/images/16x16/*
d 775 root root $home/data/images/devices -
f 644 root root $home/data/images/devices data/images/devices/*
d 775 root root $home/data/images/32x32 -
f 644 root root $home/data/images/32x32 data/images/32x32/*
d 775 root root $home/data/images/128x128 -
f 644 root root $home/data/images/128x128 data/images/128x128/*
d 775 root root $home/data/images/48x48 -
f 644 root root $home/data/images/48x48 data/images/48x48/*
d 775 root root $home/data/ps -
f 644 root root $home/data/ps/clean_page.pdf.gz data/ps/clean_page.pdf.gz
f 644 root root $home/data/ps/testpage.ps.gz data/ps/testpage.ps.gz
f 755 root root $home/testpage.py testpage.py
f 755 root root $home/systray.py systray.py
f 755 root root $home/setup.py setup.py
f 755 root root $home/makeuri.py makeuri.py
d 775 root root $home/scan -
f 755 root root $home/scan/__init__.py scan/__init__.py
f 755 root root $home/scan/sane.py scan/sane.py
f 755 root root $home/plugin.py plugin.py
f 755 root root $home/print.py print.py
f 755 root root $home/firmware.py firmware.py
d 775 root root $home/plugins -
f 755 root root $home/plugins/powersettings2.py plugins/powersettings2.py
f 755 root root $home/plugins/__init__.py plugins/__init__.py
f 755 root root $home/plugins/powersettingsdialog_base.py plugins/powersettingsdialog_base.py
f 755 root root $home/plugins/Officejet_H470.py plugins/Officejet_H470.py
f 755 root root $home/plugins/powersettingsdialog.py plugins/powersettingsdialog.py
f 755 root root $home/plugins/Deskjet_460.py plugins/Deskjet_460.py
f 755 root root $home/plugins/dj450.py plugins/dj450.py
f 755 root root $home/plugins/powersettings.py plugins/powersettings.py
d 775 root root $home/installer -
f 755 root root $home/installer/distros.dat installer/distros.dat
f 755 root root $home/installer/__init__.py installer/__init__.py
f 755 root root $home/installer/dcheck.py installer/dcheck.py
f 755 root root $home/installer/core_install.py installer/core_install.py
f 755 root root $home/colorcal.py colorcal.py
d 775 root root $home/prnt -
f 755 root root $home/prnt/pcl.py prnt/pcl.py
f 755 root root $home/prnt/cups.py prnt/cups.py
f 755 root root $home/prnt/__init__.py prnt/__init__.py
f 755 root root $home/prnt/ldl.py prnt/ldl.py
f 755 root root $home/prnt/colorcal.py prnt/colorcal.py
f 755 root root $home/clean.py clean.py
f 755 root root $home/check.py check.py
d 775 root root $home/pcard -
f 755 root root $home/pcard/__init__.py pcard/__init__.py
f 755 root root $home/pcard/photocard.py pcard/photocard.py
f 755 root root $home/info.py info.py
# docs
f 644 root root $docdir doc/*
d 775 root root $docdir/images -
f 644 root root $docdir/images doc/images/*
d 775 root root $docdir/styles -
f 644 root root $docdir/styles doc/styles/*
# python commands
l 755 root root $bindir/hp-toolbox ../share/hplip/toolbox.py
l 755 root root $bindir/hp-colorcal ../share/hplip/colorcal.py
l 755 root root $bindir/hp-sendfax ../share/hplip/sendfax.py
l 755 root root $bindir/hp-clean ../share/hplip/clean.py
l 755 root root $bindir/hp-testpage ../share/hplip/testpage.py
l 755 root root $bindir/hp-systray ../share/hplip/systray.py
l 755 root root $bindir/hp-firmware ../share/hplip/firmware.py
l 755 root root $bindir/hp-makeuri ../share/hplip/makeuri.py
l 755 root root $bindir/hp-fab ../share/hplip/fab.py
l 755 root root $bindir/hp-align ../share/hplip/align.py
l 755 root root $bindir/hp-print ../share/hplip/print.py
l 755 root root $bindir/hp-setup ../share/hplip/setup.py
l 755 root root $bindir/hp-levels ../share/hplip/levels.py
l 755 root root $bindir/hp-unload ../share/hplip/unload.py
l 755 root root $bindir/hp-probe ../share/hplip/probe.py
l 755 root root $bindir/hp-timedate ../share/hplip/timedate.py
l 755 root root $bindir/hp-plugin ../share/hplip/plugin.py
l 755 root root $bindir/hp-check ../share/hplip/check.py
l 755 root root $bindir/hp-info ../share/hplip/info.py
l 755 root root $bindir/hp-makecopies ../share/hplip/makecopies.py
l 755 root root $bindir/hp-scan ../share/hplip/scan.py
%endif
# end !UNLEADED

%if !UNLEADED qt4-install
d 775 root root $home/ui4 -
f 755 root root $home/ui4 ui4/*.py
%endif

%if !UNLEADED !qt4-install
d 775 root root $home/ui -
f 755 root root $home/ui ui/*.py
%endif

%system !darwin
# Use LINPUS8 for Acer Aspire One
%ifdef LINPUS8
f 0644 root root /etc/udev/rules.d/55-hpmud_pam.rules data/rules/55-hpmud_pam.rules
%else
f 0644 root root /etc/udev/rules.d/55-hpmud.rules data/rules/55-hpmud.rules
f 0644 root root /usr/share/hal/fdi/preprobe/10osvendor/20-hplip-devices.fdi data/rules/20-hplip-devices.fdi
%endif
%system all

%ifdef LINPUS8
%requires PyQt
%requires cupsddk-drivers
%requires cupsddk-devel
%provides hpijs $version
%endif

%ifdef FEDORA9
%requires PyQt
%provides hpijs $version
%endif

%ifdef FEDORA9_UNLEADED
%provides hpijs $version
%endif

%ifdef UBUNTU804_DEPENDENCY
%requires python-qt3
%replaces foomatic-db-hpijs
%replaces hpijs
%replaces hplip
%replaces hplip-data
%endif

%ifdef UBUNTU804_UNLEADED_DEPENDENCY
%replaces foomatic-db-hpijs
%replaces hpijs
%replaces hplip
%replaces hplip-data
%endif

%if PLUGIN
f 0644 root root $docdir/license.txt prnt/plugins/license.txt
f 0644 root root $docdir/COPYING prnt/plugins/license.txt
f 0644 root root $docdir/copyright prnt/plugins/copyright
f 0644 root root /var/lib/hp/hplip.state hplip-plugin.state
f 0644 root root $home/data/firmware data/firmware/*.fw.gz
d 0775 root root $home/data/plugin -
d 0775 root root $home/scan/plugins -
%system !darwin
f 0644 root root /etc/udev/rules.d data/rules/86-hpmud*.rules
f 0755 root root $home/prnt/plugins/lj-${machine}.so prnt/plugins/lj-${machine}.so
l 0755 root root $home/prnt/plugins/lj.so lj-${machine}.so
f 0755 root root $home/scan/plugins/bb_marvell-${machine}.so scan/sane/bb_marvell-${machine}.so
l 0755 root root $home/scan/plugins/bb_marvell.so bb_marvell-${machine}.so
f 0755 root root $home/scan/plugins/bb_soapht-${machine}.so scan/sane/bb_soapht-${machine}.so
l 0755 root root $home/scan/plugins/bb_soapht.so bb_soapht-${machine}.so
f 0755 root root $home/scan/plugins/bb_soap-${machine}.so scan/sane/bb_soap-${machine}.so
l 0755 root root $home/scan/plugins/bb_soap.so bb_soap-${machine}.so
%system all
%postinstall <<EOF
ver=`echo $version | sed 's/\([0-9]*.[0-9]*.[0-9]*\).*/\1/'`
touch $home/data/plugin/hplip-$${ver}-plugin.run
EOF
%postremove <<EOF
ver=`echo $version | sed 's/\([0-9]*.[0-9]*.[0-9]*\).*/\1/'`
rm -f $home/data/plugin/hplip-$${ver}-plugin.run
EOF
%else
f 0644 root root $docdir/COPYING COPYING
f 0644 root root $docdir/copyright copyright
f 0644 root root /var/lib/hp/hplip.state hplip.state
%system !darwin
f 0644 root root /etc/udev/rules.d/56-hpmud_support.rules data/rules/56-hpmud_support.rules
%system all
%endif
#end PLUGIN
