<!--
/*
 (c) Copyright 2001-2007 Hewlett-Packard Development Company, L.P.

 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA

 Author: Pete Parks

*/
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="PRAGMA" content="NO-CACHE" />
    <link rel="stylesheet" type="text/css" href="styles/hplip.css" />
    <script type="text/javascript" src="scripts/hplip.js"></script>
    <script type="text/javascript" src="scripts/misc_code.js"></script>
    <script type="text/javascript">
    <!--
    var operationName = "";
    var operationNumber = 0;
    var lineCount = 0;
    var statusAjaxObj = createXmlLoader();
    var statusTextAjaxObj = createXmlLoader();
    var repsonseTextAccumlative = "";
    
    function todoOnLoad() {
        getProgressOperationNumber();
        setupLoopingGraphic();
        document.getElementById("hiddenDiv").style.dislpay = 'none';
    };
    
    
    function setupLoopingGraphic() {
        document.getElementById("progressText").innerHTML='$progress_text';
        document.getElementById("progressBar").innerHTML="<img src='images/circular.gif' alt='progress'>";
        getProgressStatus();
    };
    
    
    function setOperationTitleString(serverResponse) {
      operationNumber = parseInt(serverResponse);
      if(operationNumber == 2 || operationNumber == 3) {
          var state = document.getElementById("retry_button").style.display;
          state.display = state.display? "":"hidden"; 
      }
      if(operationNumber  == 0) {
          operationName = "$profile_software_requirements";
      } else if(operationNumber  == 1) {
          operationName = "$required_dependencies";
      } else if(operationNumber  == 2) {
          operationName = "$optional_dependencies";
      } else if(operationNumber  == 3) {
          operationName = "$preparing_dependencies";
      } else if(operationNumber  == 4) {
          operationName = "$finishing_dependencies";
      } else if(operationNumber  == 5) {
          operationName = "$building_and_installing";
      } else if(operationNumber  == 6) {
          operationName = "$remove_hpoj";
      } else if(operationNumber  == 7) {
          operationName = "$remove_hplip";
      } else if(operationNumber  == 8) {
          operationName = "$restarting_cups";
      } else {
          operationName = "$unimplemented_operation";
      }
    };
    
    function getServerResponse(ajaxObj, httpOpt, filename, sync) {
      if(ajaxObj == null) {
        ajaxObj = createXmlLoader();
      }
      var localPath = "http://localhost:8888/" +  filename
      return submitXmlLoaderRequest(ajaxObj, httpOpt, localPath, sync);
    }
    
    function getProgressTextUpdate() {
      getServerResponse(statusTextAjaxObj, "POST", "progress_update", false);
    };
    
    
    function getProgressOperationNumber() {
      setOperationTitleString(getServerResponse(null, "POST", "operation_number", false));
    };

    function getProgressStatus() {
      statusResponseFromServer(parseInt(getServerResponse(statusAjaxObj, "POST", "progress_status", false)));
    };
    
    function statusResponseFromServer(status) {
      
      //getProgressTextUpdate();
      
      if( -1 == status ) { // Running 
          document.getElementById("progressText").innerHTML = "$installation_progress" + operationName;
          document.getElementById("progressBar").innerHTML = "<img src='images/circular.gif' alt='progress'>";
          setTimeout("getProgressStatus();", 200);
      } else if( 0 < status ) { // Done with Error
          document.getElementById("progressText").innerHTML = "$installation_progress_error";
          document.getElementById("progressBar").innerHTML = null;
          window.location.href = "error_command_failed";
      } else if( 0 == status ) {  // Done no Error
          indexClickActions( "next_button", "progress_controller");
      } else {
          document.getElementById("progressText").innerHTML = "$got_into_bad_state";
          document.getElementById("progressBar").innerHTML = null;
          toggleLayer("hiddenDiv");
      }
    }
    
    function setProgressElementText(responseText) {
      if(responseText) {
        lineCount = lineCount + 1;
        if(lineCount >= 200) {
          document.getElementById("scrollTextArea").innerHTML = "";
          repsonseTextAccumlative = ""
          lineCount = 0; 
        }
        if(isFireFoxBase() || isSafariBase()) {
            document.getElementById("scrollTextArea").innerHTML += responseText;
        } else { 
          repsonseTextAccumlative += responseText;
          document.getElementById("scrollTextDiv").innerHTML = '<textarea cols="62" rows="11" wrap="off" name="scrollTextArea" id="scrollTextArea" >' + repsonseTextAccumlative + '</textarea></div>';
        }
      }
    };

    -->
    </script>
<title>$installer_title</title>
</head>

<body onload="todoOnLoad();">

<!-- Header Div -->
<div id="header_box" class="background_box">
  <div class='header_title_class'>
    <div id='hp_blue_logo'><img src='images/hplogo.png' alt=''/></div>
    <div id='header_title'>$header_string</div>
    <div id='header_title2'>$header_string</div>
    <div id='header_subtitle'>$sub_header_string</div>
    <div id='header_subtitle2'>$sub_header_string</div>
    <div id='tux_logo'><img src='images/tux.png' alt=''/></div>
  </div>
</div>


<!-- Body Div -->
<div class="body_content">
     

    <div id="message_body">
      <div class="install_title_replacement"><div id="progressText"></div></div>
      <div id="progressBar"></div>
    </div>

    <div id="message_footer">
    </div>
</div>


<!-- Button Div -->
<div class="button_options">

    <div id="quit_button" OnSelectStart='return false;' onClick='todoOnQuit("quit");'> <!-- indexClickActions( "quit_button", "progress_cancel");' -->
        <img src="../images/button1.png" width="100" height="35" alt="" >
        <div id="cancel2HiliteText">$cancel_button</div>
        <div id="cancel2Text">$cancel_button</div>
    </div>

    <div id="retry_button" OnSelectStart='return false;' onClick='indexClickActions( "retry_button", "retry_progress");'>
      <img src="../images/button1.png" width="100" height="35">
      <div id="retryHiliteText">$retry_button</div>
      <div id="retryText">$retry_button</div>
    </div>

    <div id="hiddenDiv">
        <div id="next_button" OnSelectStart='return false;' onClick='indexClickActions( "next_button", "progress_controller");' >
          <img src="../images/button1.png" width="100" height="35">
          <div id="nextHiliteText">$next_button</div>
          <div id="nextText">$next_button</div>
        </div>
    </div>

</div>

</body>
</html>
